db:
    image: silintl/mariadb:latest
    environment:
        MYSQL_ROOT_PASSWORD: r00tp@ss!
        MYSQL_DATABASE: test
        MYSQL_USER: idpmgmt
        MYSQL_PASSWORD: idpmgmt

zxcvbn:
    image: wcjr/zxcvbn-api:1.1.0
    ports:
        - "3000"

memcache1:
    image: memcached:1.4-alpine
    ports:
        - "11212:11211"

memcache2:
    image: memcached:1.4-alpine
    ports:
        - "11213:11211"

api:
    build:
        image: silintl/idp-pw-api
        dockerfile_path: ./Dockerfile
        cached: true
    links:
        - db
        - memcache1
        - memcache2
        - zxcvbn
    environment:
        MYSQL_HOST: db
        MYSQL_DATABASE: test
        MYSQL_USER: idpmgmt
        MYSQL_PASSWORD: idpmgmt
        MAILER_USEFILES: true
        ALERTS_EMAIL_ENABLED: false
        ALERTS_EMAIL: alerts@nowhere.com
        MEMCACHE_CONFIG1_host: memcache1
        MEMCACHE_CONFIG1_port: 11211
        MEMCACHE_CONFIG1_weight: 100
        MEMCACHE_CONFIG2_host: memcache2
        MEMCACHE_CONFIG2_port: 11211
        MEMCACHE_CONFIG2_weight: 50
    working_dir: /data
    command: /data/run-tests.sh




